<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Project Optimist - Your Daily Dose of Positivity</title>
    <meta name="description" content="Project Optimist aggregates positive and uplifting news stories from around the world, filtering out negativity to bring you a brighter perspective.">
    <meta name="keywords" content="positive news, good news, uplifting stories, world news, technology, science, culture, lifestyle, positive aggregation">

    <!-- Fonts & CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600;700&family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" crossorigin="anonymous">
</head>

<body>
    <header>
        <h1><a href="/">Project Optimist</a></h1>
        <p>Focusing on the good news happening around the world.</p>
    </header>

    <div class="layout-container">
        <!-- FILTER SIDEBAR -->
        <aside class="filter-sidebar">
            <div class="sidebar-section">
                <h3>Categories</h3>
                <ul class="filter-list">
                    <li><a href="/" class="filter-item {% if not selected_topic %}active{% endif %}">All News</a></li>
                    {% for topic in topics %}
                        <li>
                            <a href="/?topic={{ topic }}" class="filter-item {% if selected_topic == topic %}active{% endif %}">
                                {% if topic_icons.get(topic) %}
                                    <img src="{{ url_for('static', filename=topic_icons.get(topic)) }}" alt="icon" class="filter-icon">
                                {% endif %}
                                {{ topic|title }}
                            </a>
                        </li>
                    {% endfor %}
                </ul>
            </div>
            <div class="sidebar-section">
                <h3>About</h3>
                <p class="sidebar-info">Project Optimist uses AI to find and rank the most inspiring stories on the web.</p>
                <div class="inspiration-scale">
                    <div class="scale-label">Inspiration Scale:</div>
                    <div class="scale-item">üòÄ High</div>
                    <div class="scale-item">üôÇ Medium</div>
                    <div class="scale-item">üòê Low</div>
                </div>
            </div>
        </aside>

        <!-- MAIN CONTENT -->
        <main>
            {% if articles %}
                <!-- Top Stories Section -->
                <div class="content-header">
                    <h2>üî• Top Stories</h2>
                </div>
                <div class="top-stories-container">
                    {% set top_stories = articles[:4] %}
                    {% for article in top_stories %}
      {% set inspiration = article.get('inspiration_score', 5) %}
      <article id="article-top-{{ loop.index0 }}" class="article-top">
          <!-- Content area with inspiration badge -->
          <div class="article-top-content">
              <!-- Inspiration badge moved to content area -->
              <div class="inspiration-badge">
                  {% if inspiration >= 8 %}
                      üòÄ
                  {% elif inspiration >= 5 %}
                      üôÇ
                  {% else %}
                      üòê
                  {% endif %}
              </div>

              <!-- Source info -->
              <div class="article-source">
          <a href="{{ article['link'] }}" class="source-url-chip" target="_blank">
              {{ article['source_name'] }}
          </a>
          <div class="tag-container">
              {% if article.get('topic_name') %}
              <span class="topic-tag {{ article.get('topic_name')|title }}">
                  {% if article.get('topic_icon_path') %}
                      <img src="{{ url_for('static', filename=article['topic_icon_path']) }}" alt="topic" class="emoji-icon">
                  {% endif %}
                  {{ article.get('topic_name')|title }}
              </span>
              {% endif %}

              <!-- Location tag - only shown if location is available -->
              {% if article.get('location') %}
              <span class="location-tag">
                  <i class="fas fa-map-marker-alt"></i>
                  {{ article.get('location') }}
              </span>
              {% endif %}
          </div>
      </div>

              <!-- Title with topic icon and summary -->
              <h3>
                  <a href="{{ article['link'] }}" target="_blank">
                      {% if article.get('topic_icon_path') %}
                      <span class="title-icon" style="background-image: url('{{ url_for('static', filename=article['topic_icon_path']) }}');"></span>
                      {% endif %}
                      {{ article['title'] }}
                  </a>
              </h3>
              <p class="summary">{{ article['summary'] | striptags | truncate(100) }}</p>

              <!-- Date -->
              <small class="published">{{ article['published'] | format_datetime }}</small>
          </div>
      </article>

                    {% endfor %}
                </div>

                <!-- Remaining Articles Section -->
                <div class="content-header">
                    <h2>More Positive News</h2>
                </div>
                {% for article in articles[4:] %}
      {% set inspiration = article.get('inspiration_score', 5) %}
      <article id="article-{{ loop.index0 }}" class="article-flat">
          {% if article.get('image_url') %}
              <div class="thumbnail-container">
                  <img src="{{ article['image_url'] }}" alt="Thumbnail" class="thumbnail">
                  <div class="inspiration-badge small">
                      {% if inspiration >= 8 %}
                          üòÄ
                      {% elif inspiration >= 5 %}
                          üôÇ
                      {% else %}
                          üòê
                      {% endif %}
                  </div>
              </div>
          {% endif %}
          <div class="article-content">
              <h3>
                  <a href="{{ article['link'] }}" target="_blank">
                      {% if article.get('topic_icon_path') %}
                      <span class="title-icon" style="background-image: url('{{ url_for('static', filename=article['topic_icon_path']) }}');"></span>
                      {% endif %}
                      {{ article['title'] }}
                  </a>
              </h3>
              <p class="summary">{{ article['summary'] | striptags | truncate(100) }}</p>
              <div class="article-meta">
                  <span class="source-name">{{ article['source_name'] }}</span>
                  {% if article.get('topic_name') %}
                  <span class="topic-tag {{ article.get('topic_name')|title }}">
                      {% if article.get('topic_icon_path') %}
                          <img src="{{ url_for('static', filename=article['topic_icon_path']) }}" alt="topic" class="emoji-icon">
                      {% endif %}
                      {{ article.get('topic_name')|title }}
                  </span>
                  {% endif %}
              </div>
              <small class="published">{{ article['published'] | format_datetime }}</small>
          </div>
      </article>
  {% endfor %}
            {% else %}
                <p class="no-articles">No articles available.</p>
            {% endif %}
        </main>

        <!-- RIGHT SIDEBAR (for ads, can be empty for now) -->
        <aside class="ad-sidebar">
            <!-- This can remain empty as mentioned in your design -->
        </aside>
    </div>

    <footer>
        <p>&copy; {{ now.year }} Project Optimist. All rights reserved.</p>
        <p>Powered by Good Vibes</p>
    </footer>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Make source names a little more subtle
        const colors = ['#3498db', '#2ecc71', '#9b59b6', '#34495e', '#16a085', '#27ae60', '#2980b9', '#8e44ad', '#2c3e50'];
        document.querySelectorAll('.source-name').forEach(el => {
            const color = colors[Math.floor(Math.random() * colors.length)];
            el.style.color = color;
            el.style.opacity = '0.8';
        });
    });
    </script>
</body>
</html>
